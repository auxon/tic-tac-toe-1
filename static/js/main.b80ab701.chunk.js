(this["webpackJsonptic-tac-toe"]=this["webpackJsonptic-tac-toe"]||[]).push([[0],{107:function(t,e){},182:function(t,e){},201:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return h}));var r=n(2),a=n.n(r),s=n(6),c=n(19),i=n(28),u=n(49),o=n(48),l=n(47),p=n(5),f=n(23),h=function(e){Object(u.a)(r,e);var n=Object(o.a)(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.a.Testnet;return Object(c.a)(this,r),(t=n.call(this,e)).sensilet=void 0,"undefined"!==typeof window.sensilet?(console.log(r.DEBUG_TAG,"Sensilet is installed!"),t.sensilet=window.sensilet):console.warn(r.DEBUG_TAG,"sensilet is not installed"),t}return Object(i.a)(r,[{key:"requestAccount",value:function(t,e){if(!this.sensilet){if("undefined"!==typeof window.sensilet)return console.log(r.DEBUG_TAG,"Sensilet is installed!"),this.sensilet=window.sensilet,this.sensilet.requestAccount();alert("sensilet is not installed"),window.open("https://sensilet.com/","_blank")}return this.sensilet.requestAccount()}},{key:"isConnected",value:function(){var t=Object(s.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,console.log(r.DEBUG_TAG,"isConnect"),"undefined"===typeof this.sensilet){t.next=8;break}return t.next=5,this.sensilet.isConnect();case 5:return e=t.sent,console.log(r.DEBUG_TAG,"connect state",e),t.abrupt("return",e);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("isConnected error",t.t0);case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}()},{key:"getbalance",value:function(){var t=Object(s.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.sensilet.getBsvBalance();case 3:return e=t.sent,console.log(r.DEBUG_TAG,"getbalance",e.balance),t.abrupt("return",Promise.resolve(e.balance.total));case 8:t.prev=8,t.t0=t.catch(0),console.error("getbalance error",t.t0);case 11:return t.abrupt("return",Promise.resolve(0));case 12:case"end":return t.stop()}}),t,this,[[0,8]])})));return function(){return t.apply(this,arguments)}}()},{key:"signRawTransaction",value:function(){var e=Object(s.a)(a.a.mark((function e(n,r,s,c,i){var u,o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=new p.bsv.Transaction(n),e.next=3,this.sensilet.signTx({list:[{txHex:n,address:b(r,this.network),scriptHex:r,inputIndex:c,satoshis:s,sigtype:i}]});case 3:return o=e.sent,l=(new p.bsv.Script).add(t.from(o.sigList[0].sig,"hex")).add(t.from(o.sigList[0].publicKey,"hex")),u.inputs[c].setScript(l),e.abrupt("return",u.toString());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,s){return e.apply(this,arguments)}}()},{key:"getSignature",value:function(){var t=Object(s.a)(a.a.mark((function t(e,n,r,s,c,i){var u;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sensilet.signTx({list:[{txHex:e,address:i,inputIndex:s,satoshis:r,scriptHex:n,sigtype:c}]});case 2:return u=t.sent,t.abrupt("return",{signature:u.sigList[0].sig,publickey:u.sigList[0].publickey});case 4:case"end":return t.stop()}}),t,this)})));return function(e,n,r,a,s,c){return t.apply(this,arguments)}}()},{key:"sendRawTransaction",value:function(){var t=Object(s.a)(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",f.b.sendRawTransaction(e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"listUnspent",value:function(){var t=Object(s.a)(a.a.mark((function t(e,n){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sensilet.getAddress();case 2:return s=t.sent,console.log(r.DEBUG_TAG,"listUnspent",s),t.abrupt("return",f.b.listUnspent(s).then((function(t){return t.data.filter((function(t){return t.value>=e})).map((function(t){return{txId:t.tx_hash,outputIndex:t.tx_pos,satoshis:t.value,script:p.bsv.Script.buildPublicKeyHashOut(s).toHex()}}))})));case 5:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getRawChangeAddress",value:function(){var t=Object(s.a)(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.sensilet.getAddress());case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getPublicKey",value:function(){var t=Object(s.a)(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.sensilet.getPublicKey());case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getNetwork",value:function(){var t=Object(s.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sensilet.getAddress();case 2:return n=t.sent,r=new p.bsv.Address.fromString(n),t.abrupt("return","testnet"===r.network.name?f.a.Testnet:f.a.Mainnet);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),r}(l.b);function b(t,e){var n=p.bsv.Script.fromHex(t).toASM().split(" ")[2];return new p.bsv.Address.fromHex("".concat(e===f.a.Testnet?"6f":"00").concat(n)).toString()}h.DEBUG_TAG="Sensilet"}).call(this,n(1).Buffer)},207:function(t,e,n){},209:function(t,e,n){},219:function(t,e){},225:function(t,e){},226:function(t,e){},23:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return p}));var r,a=n(2),s=n.n(a),c=n(6),i=n(19),u=n(28),o=n(64),l=n.n(o);!function(t){t.Testnet="testnet",t.Regtest="regtest",t.Mainnet="mainnet",t.STN="STN"}(r||(r={}));var p=function(){function t(){Object(i.a)(this,t)}return Object(u.a)(t,null,[{key:"setNetwork",value:function(e){t.API_PREFIX="https://api.whatsonchain.com/v1/bsv/".concat(e===r.Testnet?"test":"main"),t.TX_URL_PREFIX="".concat(e===r.Testnet?"https://test.whatsonchain.com/tx":"https://whatsonchain.com/tx")}},{key:"sendRawTransaction",value:function(){var e=Object(c.a)(s.a.mark((function e(n){var r,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Math.max(1,n.length/2/1024),a=Math.max(1e4,1e3*r),e.prev=2,e.next=5,l.a.post("".concat(t.API_PREFIX,"/tx/raw"),{txhex:n},{timeout:a});case 5:return c=e.sent,e.abrupt("return",c.data);case 9:throw e.prev=9,e.t0=e.catch(2),new Error("sendRawTransaction error: ");case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"listUnspent",value:function(){var e=Object(c.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l.a.get("".concat(t.API_PREFIX,"/address/").concat(n,"/unspent"),{timeout:1e4}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTxUri",value:function(e){return"".concat(t.TX_URL_PREFIX,"/").concat(e)}}]),t}();p.API_PREFIX="",p.TX_URL_PREFIX=""},247:function(t,e){},249:function(t,e){},259:function(t,e){},261:function(t,e){},288:function(t,e){},290:function(t,e){},295:function(t,e){},297:function(t,e){},309:function(t,e){},312:function(t,e){},392:function(t,e,n){"use strict";n.r(e);var r=n(10),a=n.n(r),s=n(202),c=n.n(s),i=(n(207),n(2)),u=n.n(i),o=n(35),l=n(6),p=(n(209),n(19)),f=n(28),h=n(49),b=n(48),d=n(5),v=n(47),j=n(64),w=n.n(j),g=function(){function t(){Object(p.a)(this,t)}return Object(f.a)(t,null,[{key:"setWallet",value:function(e){t.wallet=e}},{key:"version",value:function(){return"0.0.2"}},{key:"loadContract",value:function(t){return w.a.get(t,{timeout:1e4}).then((function(t){var e=Object(d.buildContractClass)(t.data);return{contractClass:e,types:Object(d.buildTypeClasses)(e)}}))}},{key:"getChangeAddress",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.wallet.getRawChangeAddress());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"sendRawTx",value:function(){var e=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.wallet.sendRawTransaction(n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deploy",value:function(){var e=Object(l.a)(u.a.mark((function e(n,r){var a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.wallet,e.next=3,t.wallet.getRawChangeAddress();case 3:return s=e.sent,e.abrupt("return",a.listUnspent(r,{purpose:"tic-tac-toe"}).then((function(t){if(0===t.length)throw new Error("no utxo available");var e=new d.bsv.Transaction;return e.from([t[0]]).addOutput(new d.bsv.Transaction.Output({script:n.lockingScript,satoshis:r})).change(s),a.signRawTransaction(e.toString(),t[0].script,t[0].satoshis,0,v.a.ALL)})).then(function(){var e=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sendRawTx(n);case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=Object(l.a)(u.a.mark((function e(n,r){var a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.wallet,(a=new d.bsv.Transaction).addInput(new d.bsv.Transaction.Input({prevTxId:n.txId,outputIndex:n.outputIndex,script:new d.bsv.Script,output:new d.bsv.Transaction.Output({script:n.script,satoshis:n.satoshis})})),r(a),s=a.toString(),e.next=7,t.sendRawTx(s);case 7:return e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),t}();g.wallet=void 0;var x=n(201),O=n(23),m=n(0),y=function(t){var e=t.value?O.b.getTxUri(t.value.tx):"",n=t.value?Object(m.jsx)("div",{className:"squareicon",children:t.value.n}):"";return Object(m.jsxs)("div",{className:"squarewapper",children:[Object(m.jsx)("button",{className:"".concat(t.winnerClass," square"),onClick:t.onClick,children:t.value?Object(m.jsx)("a",{href:e,target:"_blank",title:"Click to see the transaction",children:t.value.label}):t.value}),n]})},k=function(t){Object(h.a)(n,t);var e=Object(b.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(f.a)(n,[{key:"createBoard",value:function(t,e){for(var n=[],r=0,a=0;a<t;a+=1){for(var s=[],c=0;c<e;c+=1)s.push(this.renderSquare(r++));n.push(Object(m.jsx)("div",{className:"board-row",children:s},a))}return n}},{key:"renderSquare",value:function(t){var e=this,n=!this.props.winnerSquares||this.props.winnerSquares[0]!==t&&this.props.winnerSquares[1]!==t&&this.props.winnerSquares[2]!==t?"":"square--green";return Object(m.jsx)(y,{winnerClass:n,value:this.props.squares[t],onClick:function(){return e.props.onClick(t)}},t)}},{key:"render",value:function(){return Object(m.jsx)("div",{children:this.createBoard(3,3)})}}]),n}(a.a.Component),S="alice",N="bob",T=function(t){return localStorage.getItem(t)},A=function(t,e){localStorage.setItem(t,e)},I=function(t){var e=T(t),n=new d.bsv.PrivateKey.fromWIF(e),r=d.bsv.PublicKey.fromPrivateKey(n);return Object(d.toHex)(r)},C=function(t){var e=T(t);return new d.bsv.PrivateKey.fromWIF(e).toAddress().toString()},E=function(){return localStorage.player||S},P=function(t){localStorage.setItem("player",t)},R={get:function(){var t=localStorage.game;return t?JSON.parse(t):{}},set:function(t){localStorage.setItem("game",JSON.stringify(t))},update:function(t){var e=R.get();localStorage.setItem("game",JSON.stringify(Object.assign(e,t)))},clear:function(){localStorage.setItem("game",JSON.stringify({}))}},_={add:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new d.bsv.Transaction(t),r=_.get(),a={utxo:{txId:n.id,outputIndex:e,satoshis:n.outputs[e].satoshis,script:n.outputs[e].script.toHex()},rawTx:t};return r.push(a),_.set(r),a},get:function(){var t=localStorage.utxos;return t?JSON.parse(t):[]},set:function(t){localStorage.setItem("utxos",JSON.stringify(t))},clear:function(){localStorage.setItem("utxos",JSON.stringify([]))},getlast:function(){var t=_.get();return t[t.length-1]},getdeploy:function(){return _.get()[0]}},q=1,L=2,F=3;var G=function(t){var e=Object(r.useRef)(null),n=function(){var n=Object(l.a)(u.a.mark((function n(r){var a,s;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((a=parseInt(e.current.value))<9e4)){n.next=4;break}return alert("invalid amount, at least 90000 satoshis"),n.abrupt("return");case 4:if(isNaN(a)){n.next=15;break}if(!g.wallet){n.next=12;break}return n.next=8,g.wallet.getbalance();case 8:if(s=n.sent,!(a>s)){n.next=12;break}return alert("Not enough funds. Please fund your wallet address first"),n.abrupt("return");case 12:t.onStart(a),n.next=16;break;case 15:console.error("".concat(e.current.value," is not number"));case 16:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),a=function(e){t.onCancel()};return t.gameStatus===L?Object(m.jsxs)("div",{children:["The game is in progress ...",Object(m.jsx)("button",{className:"pure-button cancel",onClick:a,children:"Restart"})]}):t.gameStatus===F?Object(m.jsxs)("div",{children:["The game is over.",Object(m.jsx)("button",{className:"pure-button cancel",onClick:a,children:"Restart"})]}):Object(m.jsxs)("div",{children:[Object(m.jsxs)("label",{children:["Bet amount:",Object(m.jsx)("input",{ref:e,type:"number",name:"amount",min:"1",defaultValue:9e4,placeholder:"in satoshis"})]}),Object(m.jsx)("button",{className:"start",onClick:n,children:"Start"})]})},B=function(t){var e=t.history.slice(0,t.currentStepNumber+1),n=e[e.length-1].squares.slice();if(t.currentStepNumber>0)return{isAliceTurn:t.isAliceTurn,board:n.map((function(t){return t&&"X"===t.label?1:t&&"O"===t.label?2:0}))}},U=function(t){for(var e=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],n=0;n<e.length;n+=1){var r=Object(o.a)(e[n],3),a=r[0],s=r[1],c=r[2];if(t[a]&&t[s]&&t[c]&&t[a].label===t[s].label&&t[a].label===t[c].label)return{winner:t[a],winnerRow:e[n]}}return{winner:null,winnerRow:null}},K=function(t){return{0:"row: 1, col: 1",1:"row: 1, col: 2",2:"row: 1, col: 3",3:"row: 2, col: 1",4:"row: 2, col: 2",5:"row: 2, col: 3",6:"row: 3, col: 1",7:"row: 3, col: 2",8:"row: 3, col: 3"}[t]},H={history:[{squares:Array(9).fill(null)}],currentStepNumber:0,isAliceTurn:!0},M=function(t){Object(h.a)(n,t);var e=Object(b.a)(n);function n(t){var r;Object(p.a)(this,n),r=e.call(this,t);var a=R.get();return 0!==Object.keys(a).length?r.state=a:r.state=H,r.attachState(),r}return Object(f.a)(n,[{key:"clean",value:function(){this.setState(H)}},{key:"attachState",value:function(){var t=B(this.state);t&&this.props.contractInstance&&(this.props.contractInstance.isAliceTurn=t.isAliceTurn,this.props.contractInstance.board=t.board)}},{key:"canMove",value:function(t,e,n){var r=R.get();if(!r||0===Object.keys(r).length)return alert("Please start game first."),!1;if(U(n).winner||n[e])return!1;var a=E();return!(a!==S||!t)||(a===N&&!this.state.isAliceTurn||(alert("now is ".concat(this.state.isAliceTurn?"Alice":"Bob"," turn ")),!1))}},{key:"handleClick",value:function(t){var e=this,n=this.state.history.slice(0,this.state.currentStepNumber+1),r=n[n.length-1].squares.slice();if(this.canMove(this.state.isAliceTurn,t,r)){var a=Object.assign({},this.state);r[t]={label:this.state.isAliceTurn?"X":"O"};var s=_.getlast().utxo,c=U(r).winner,i={status:c||n.length>=9?F:L,history:n.concat([{squares:r,currentLocation:K(t),stepNumber:n.length}]),isAliceTurn:!this.state.isAliceTurn,currentStepNumber:n.length};this.setState(i),g.call(s,(function(r){if(c){var a=C(E());r.setOutput(0,(function(t){return new d.bsv.Transaction.Output({script:d.bsv.Script.buildPublicKeyHashOut(a),satoshis:s.satoshis-t.getEstimateFee()})}))}else if(n.length>=9)r.setOutput(0,(function(t){return new d.bsv.Transaction.Output({script:d.bsv.Script.buildPublicKeyHashOut(C(S)),satoshis:Math.ceil((s.satoshis-t.getEstimateFee())/2)})})).setOutput(1,(function(t){return new d.bsv.Transaction.Output({script:d.bsv.Script.buildPublicKeyHashOut(C(N)),satoshis:Math.ceil((s.satoshis-t.getEstimateFee())/2)})}));else{var u=B(i),o=e.props.contractInstance.getNewStateScript(u);r.setOutput(0,(function(t){var e=s.satoshis-t.getEstimateFee();return new d.bsv.Transaction.Output({script:o,satoshis:e})}))}r.setInputScript(0,(function(r,a){var i=Object(d.getPreimage)(r,a.script,a.satoshis),u=new d.bsv.PrivateKey.fromWIF(T(E())),o=Object(d.signTx)(r,u,a.script,a.satoshis),l=0;if((l=c?s.satoshis-r.getEstimateFee():n.length>=9?Math.ceil((s.satoshis-r.getEstimateFee())/2):s.satoshis-r.getEstimateFee())<1)throw alert("Not enough funds."),new Error("Not enough funds.");return e.props.contractInstance.move(t,o,l,i).toScript()})).seal()})).then((function(a){var s=_.add(a);r[t].tx=s.utxo.txId,r[t].n=n.length,c||P(e.state.isAliceTurn?S:N);var i=Object.assign({},e.state,{history:n.concat([{squares:r,currentLocation:K(t),stepNumber:n.length}])});e.setState(i),R.update(i),e.props.updateGameStatus(),e.attachState()})).catch((function(t){e.setState(a),console.error("call contract fail",t)}))}else console.error("can not move now!")}},{key:"render",value:function(){var t,e,n,r,a=this,s=this.state.history,c=s[this.state.currentStepNumber],i=U(c.squares),u=i.winner,o=i.winnerRow,l=_.getdeploy(),p=_.getlast();if(n=E()===N?Object(m.jsxs)("div",{className:"bob",children:["Bob",Object(m.jsx)("img",{src:"/tic-tac-toe/bob.png"})]}):Object(m.jsxs)("div",{className:"alice",children:["Alice",Object(m.jsx)("img",{src:"/tic-tac-toe/alice.jpg"})]}),l&&(r=Object(m.jsxs)("div",{className:"bet",children:[Object(m.jsx)("a",{href:O.b.getTxUri(l.utxo.txId),target:"_blank",children:"Deploy transaction"})," "]})),u){var f="X"===u.label?"Alice":"Bob";t="Winner is ".concat(f),p&&(e=Object(m.jsxs)("div",{className:"end",children:[Object(m.jsx)("a",{href:O.b.getTxUri(l.utxo.txId),target:"_blank",children:"Withdraw transaction"})," "]}))}else if(10===s.length)t="Draw. No one won.",p&&(e=Object(m.jsxs)("div",{className:"end",children:[Object(m.jsx)("a",{href:O.b.getTxUri(l.utxo.txId),target:"_blank",children:"Withdraw transaction"})," "]}));else{var h=this.state.isAliceTurn?"Alice":"Bob";t="Next player: ".concat(h)}return Object(m.jsx)("div",{className:"game",children:Object(m.jsxs)("div",{className:"game-board",children:[Object(m.jsxs)("div",{className:"game-title",children:[n,Object(m.jsxs)("div",{className:"game-status",children:[" ",t," "]})]}),Object(m.jsx)(k,{squares:c.squares,winnerSquares:o,onClick:function(t){return a.handleClick(t)}}),Object(m.jsxs)("div",{className:"game-bottom",children:[r,e]})]})})}}]),n}(a.a.Component),X=function(t){var e=Object(r.useState)(0),n=Object(o.a)(e,2),a=n[0],s=n[1],c=Object(r.useState)(""),i=Object(o.a)(c,2),p=i[0],f=i[1],h=Object(r.useState)(""),b=Object(o.a)(h,2),d=b[0],v=b[1];return Object(r.useEffect)(Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g.wallet&&(g.wallet.getbalance().then((function(t){s(t)})),g.wallet.getRawChangeAddress().then((function(t){f(t)})),g.wallet.getNetwork().then((function(t){t===O.a.Testnet?v("Testnet"):v("Mainnet")})));case 1:case"end":return t.stop()}}),t)}))),[]),Object(m.jsx)("div",{className:"wallet",children:Object(m.jsx)("div",{className:"walletInfo",children:Object(m.jsxs)("div",{className:"balance",children:[Object(m.jsxs)("label",{children:["Balance: ",a," ",Object(m.jsx)("span",{children:" (satoshis)"})]}),Object(m.jsx)("br",{}),Object(m.jsxs)("label",{children:["NetWork: ",d," "]}),Object(m.jsx)("br",{}),Object(m.jsxs)("label",{children:["Address: ",p," "]})]})})})},D=function(t){var e=function(){var t=Object(l.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.wallet.requestAccount("tic-tac-toe");case 3:t.sent&&window.location.reload(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("requestAccount error",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"auth",children:Object(m.jsx)("div",{children:Object(m.jsx)("button",{className:"pure-button button-large sensilet",onClick:e,children:"Sensilet"})})})},W=function(){return Object(m.jsxs)("footer",{children:["Made by ",Object(m.jsx)("a",{href:"https://scrypt.io",target:"_blank",rel:"noopener noreferrer",children:"sCrypt Inc"})," ",Object(m.jsx)("br",{}),"Github ",Object(m.jsx)("a",{href:"https://github.com/sCrypt-Inc/tic-tac-toe",target:"_blank",rel:"noopener noreferrer",children:"Repo"})," "]})};function Y(t,e){return J.apply(this,arguments)}function J(){return(J=Object(l.a)(u.a.mark((function t(e,n){var r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.loadContract("/tic-tac-toe/tictactoe_release_desc0.json");case 2:return r=t.sent,a=r.contractClass,t.abrupt("return",new a(new d.PubKey(e),new d.PubKey(n),!0,[0,0,0,0,0,0,0,0,0]));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var V=function(){var t=a.a.createRef(),e=Object(r.useState)({gameStatus:q,isConnected:!1,instance:null}),n=Object(o.a)(e,2),s=n[0],c=n[1];Object(r.useEffect)(Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=setTimeout(Object(l.a)(u.a.mark((function t(){var e,n,r,a,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y(I(S),I(N));case 2:return e=t.sent,n=new x.a,g.setWallet(n),t.next=7,g.wallet.isConnected();case 7:if(!(r=t.sent)){t.next=13;break}return t.next=11,n.getNetwork();case 11:a=t.sent,g.setWallet(new x.a(a));case 13:c(Object.assign({},s,{isConnected:r,instance:e})),i=R.get(),Object.keys(R.get()).length>0?c({gameStatus:i.status,isConnected:r,instance:e}):c({gameStatus:q,isConnected:r,instance:e});case 16:case"end":return t.stop()}}),t)}))),100),t.abrupt("return",(function(){clearTimeout(e)}));case 2:case"end":return t.stop()}}),t)}))),[]);var i=function(){var t=Object(l.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g.wallet&&s.instance&&g.deploy(s.instance,e).then((function(t){var n={amount:e,name:"tic-tac-toe",date:new Date,history:[{squares:Array(9).fill(null)}],currentStepNumber:0,isAliceTurn:!0,status:L};_.add(t),R.set(n),P(S),c(Object.assign({},s,{gameStatus:L}))})).catch((function(t){alert(t.message),console.error(t)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R.clear(),_.clear(),P(S),s.instance&&(s.instance.isAliceTurn=!0,s.instance.board=[0,0,0,0,0,0,0,0,0]),t.current.clean(),c({gameStatus:q,isConnected:s.isConnected,instance:s.instance});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=R.get(),Object.keys(R.get()).length>0?c(Object.assign({},s,{gameStatus:e.status})):c({gameStatus:q});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsxs)("header",{className:"App-header",children:[Object(m.jsx)("h2",{children:"Play Tic-Tac-Toe on Bitcoin"}),Object(m.jsx)(G,{onStart:i,onCancel:p,gameStatus:s.gameStatus}),Object(m.jsx)(M,{ref:t,contractInstance:s.instance,updateGameStatus:f}),s.isConnected?Object(m.jsx)(X,{}):Object(m.jsx)(D,{})]}),Object(m.jsx)(W,{})]})},z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,393)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,s=e.getLCP,c=e.getTTFB;n(t),r(t),a(t),s(t),c(t)}))};!function(){if(!T(S)){var t=new d.bsv.PrivateKey.fromRandom;A(S,t.toWIF())}if(!T(N)){var e=new d.bsv.PrivateKey.fromRandom;A(N,e.toWIF())}}(),c.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(V,{})}),document.getElementById("root")),z()},47:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return c}));var r,a=n(19),s=n(23);!function(t){t[t.ALL=65]="ALL",t[t.SINGLE=67]="SINGLE",t[t.NONE=66]="NONE",t[t.ANYONECANPAY_ALL=193]="ANYONECANPAY_ALL",t[t.ANYONECANPAY_SINGLE=195]="ANYONECANPAY_SINGLE",t[t.ANYONECANPAY_NONE=194]="ANYONECANPAY_NONE"}(r||(r={}));var c=function t(e){Object(a.a)(this,t),this.network=void 0,this.network=e,s.b.setNetwork(this.network)}}},[[392,1,2]]]);
//# sourceMappingURL=main.b80ab701.chunk.js.map